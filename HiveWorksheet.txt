CREATE DATABASE hivedb;

set hive.cli.print.current.db=true;

use hivedb;

--Creating Internal Table
--STRING
CREATE TABLE weather (wban INT, date STRING, precip INT)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n';

sudo su hdfs
hdfs dfs –copyFromLocal /home/user/data/weather/2012.txt user/data/weather/2012.txt
LOAD DATA INPATH '/user/cloudera/data/2012.txt' INTO TABLE weather;

describe formatted weather;

###

--DATE
CREATE TABLE weather (wban INT, date date, precip INT)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ‘,’
LOCATION ‘ /hive/data/weather’;

hadoop fs –copyFromLocal /home/user/data/weather/2012.txt hdfs://hname:10001/hive/data/weather
LOAD DATA INPATH ‘hdfs:/data/2012.txt’ INTO TABLE weather;

--TIMESTAMP
CREATE TABLE weather (wban INT, date timestamp, precip INT)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ‘,’
LOCATION ‘ /hive/data/weather’;

hadoop fs –copyFromLocal /home/user/data/weather/2012.txt hdfs://hname:10001/hive/data/weather
LOAD DATA INPATH ‘hdfs:/data/2012.txt’ INTO TABLE weather;

--2012.txt
1,1997-12-15 11:32:21
2,2011-12-01 00:00:00.000
3,2014-09-10 00:00:00.000
4,2008-04-21
5,2012-01-15 11:32:21
6,2012-02-15 11:32:21
7,2012-01-15 11:32:21
8,2012-12-15 11:32:21
9,2012-01-15 11:32:21
10,2012-02-15 11:32:21


--View
CREATE VIEW AS precipitation_data SELECT * FROM weather WHERE precip IS NOT NULL AND precip>0;

SELECT * FROM precipitation_data;

--Indexing
CREATE INDEX date_index ON TABLE weather (date) AS ‘COMPACT’ WITH REBUILD;

--Creating External Table
CREATE EXTERNAL TABLE weatherext ( wban INT, date STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ‘,’
LOCATION ‘ /hive/data/weatherext’;

LOAD DATA INPATH ‘hdfs:/data/2012.txt’ INTO TABLE weatherext;

--Partitioning of table
CREATE EXTERNAL TABLE IF NOT EXSISTS weatherextpart ( wban INT, date STRING)
PARTITIONED BY (year INT, month STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ‘,’
LOCATION ‘ /hive/data/weatherext’;

LOAD DATA INPATH ‘hdfs:/data/2012.txt’ INTO TABLE weatherext PARTITION (year=2012, month=’01’);
LOAD DATA INPATH ‘hdfs:/data/2012.txt’ INTO TABLE weatherext PARTITION (year=2012, month=’02’);


http://www.hadoopinsight.com/blog/hive/hive-static-vs-dynamic-partition/

http://hadooptutorial.info/partitioning-in-hive/
