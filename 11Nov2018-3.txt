http://baahu.in/spark-add-a-new-column-to-a-dataframe-using-udf-and-withcolumn/